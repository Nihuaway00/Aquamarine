# Aquamarine
Сервис для удобной работы с PDF файлами, поддерживающий большие объемы пользователей и предоставляющий базовые операции с PDF файлами. Пользователь может использовать все инструменты бесплатно без регистрации.

## 1. Цели проекта:
1. Изучить актуальные на рынке инструменты (NestJS, TypeORM, Jest, NGINX, Swagger)
2. Изучить на практике развертывание веб-сервиса
3. Реализовать готовый к демонстрации продукт

## 2. Функциональные требования
_MVP_
#### Файлы
- Загрузка и скачивание файлов
- Ограничение по типу файлов (в зависимости от выбранного инструмента)
- Проверка файла на повреждения

#### Работа с PDF
- объединить, разделить, удалить страницы, сжать

----
_Полная версия_

#### Файлы
- асинхронная обработка
- Временное хранение файлов с возможностью загрузить по ссылке

#### Интерфейс
Web-интерфейс для использования сервиса

#### Логирование

## 3. Нефункциональные требования

#### Обработка и хранение файлов
- Лимит размера одного файла: 50 мБайт
- Инструменты, принимающие несколько файлов, имеют ограничение в 10 файлов
#### Масштабируемость
- ❗️Возможность создания реплик для увеличения производительности
- Логика приложения должна быть разделена на модули
#### Безопасность
- ❗️Ограничение числа запросов (Rate Limiting) для предотвращения DDoS-атак.
#### Удобство использования
- Отображение статуса обработки файла
#### Тестирование
- ❗️Сервер должен быть протестирован на нагрузку
- Наличие юнит-тестов и e2e тестов
#### Поддерживаемость
- Подробная Swagger-документация для API
- Код должен следовать стандартам (Eslint + Prettier)

## 4. Технические требования
### Технолоигческий стек
- Серверный фреймворк: NestJS
- БД: MySQL + TypeORM
- Хранилище файлов: MinIO
- ❗️Очереди задач: RabbitMQ
- ❗️Деплой: Docker + NGINX + PM2
- CI/CD: Github Actions
- Документация: Swagger
- Логирование: Pino + logtail
- ❗️Тестирование: Jest
### Дополнительно
- Модифицкация PDF файлов: Pdf-lib + compress-pdf

## 5. Пользовательские сценарии

### 1. Загрузка и обработка одного PDF-файла
**Предыстория:** Пользователь хочет быстро удалить страницы из PDF-файла.  
**Шаги:**
1. Пользователь заходит на главную страницу веб-сервиса.
2. выбирает действие **"Удалить страницы"**.
3. Нажимает кнопку **"Загрузить файл"**.
4. Выбирает PDF-файл размером до 50 МБ на своем устройстве.
6. Указывает страницы для удаления.
7. Нажимает **"Обработать"**.
8. Дожидается завершения обработки (видит актуальное состояние обработки).
9. Скачивает обработанный PDF-файл, нажав кнопку **"Скачать файл"**.

---

### 2. Объединение нескольких PDF-файлов
**Предыстория:** Пользователь хочет объединить два документа в один.  
**Шаги:**
1. Пользователь открывает сервис в браузере.
2. Выбирает опцию **"Объединить PDF"**.
3. Нажимает кнопку **"Загрузить файлы"**.
4. Выбирает несколько PDF-файлов (каждый не превышает 50 МБ).
6. Устанавливает порядок объединения (например, файл 1 → файл 2).
7. Нажимает **"Обработать"**.
8. После завершения обработки скачивает объединенный PDF-файл.

---

### 3. Обработка поврежденного файла
**Предыстория:** Пользователь случайно загрузил поврежденный файл.  
**Шаги:**
1. ...
1. Пользователь загружает PDF-файл через интерфейс.
2. Сервис проверяет файл на повреждения.
3. Если файл поврежден, пользователь видит сообщение: **"Файл поврежден или не поддерживается"**.
4. Пользователь загружает другой файл для обработки.

---

### 4. Сжатие PDF-файла
**Предыстория:** Пользователь хочет уменьшить размер файла для отправки по почте.  
**Шаги:**
1. Выбирает действие **"Сжать PDF"**.
2. Пользователь загружает PDF-файл.
3. Выбирает настройки сжатия (например, "Максимальная компрессия").
4. Нажимает **"Обработать"**.
5. Получает обработанный файл для скачивания.

---

### 5. Обработка ошибки превышения лимита размера файла
**Предыстория:** Пользователь пытается загрузить файл больше 50 МБ.  
**Шаги:**
1. ...
1. Пользователь загружает файл через интерфейс.
2. Сервис проверяет размер файла.
3. Если файл превышает 50 МБ, пользователь видит сообщение: **"Файл превышает допустимый размер (50 МБ)"**.

## 6. Архитектура
- Брокер сообщений (RabbitMQ)
- База данных (MySQL)
- Бекенд для взаимодействия с фронтэндом (продюссер задач)
- Реплики бекенда для обработке файлов (испольнитель)
